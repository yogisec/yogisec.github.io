<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Yogi's Vulnerable SAML app | JellyParks</title><meta name=keywords content="saml,identity,ctf"><meta name=description content="Overview of a vulnerable saml platform built to allow for various saml exploits to occur."><meta name=author content="Travis"><link rel=canonical href=https://jellyparks.com/posts/vulnerable-saml-app/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jellyparks.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-13VPCR43BS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-13VPCR43BS",{anonymize_ip:!1})}</script><meta property="og:title" content="Yogi's Vulnerable SAML app"><meta property="og:description" content="Overview of a vulnerable saml platform built to allow for various saml exploits to occur."><meta property="og:type" content="article"><meta property="og:url" content="https://jellyparks.com/posts/vulnerable-saml-app/"><meta property="og:image" content="https://jellyparks.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-28T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-28T00:00:00+00:00"><meta property="og:site_name" content="JellyParks"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jellyparks.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Yogi's Vulnerable SAML app"><meta name=twitter:description content="Overview of a vulnerable saml platform built to allow for various saml exploits to occur."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://jellyparks.com/posts/"},{"@type":"ListItem","position":3,"name":"Yogi's Vulnerable SAML app","item":"https://jellyparks.com/posts/vulnerable-saml-app/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Yogi's Vulnerable SAML app","name":"Yogi\u0027s Vulnerable SAML app","description":"Overview of a vulnerable saml platform built to allow for various saml exploits to occur.","keywords":["saml","identity","ctf"],"articleBody":" What is this thing? I built this app because I wanted to better understand SAML and I wanted to know how to discover, exploit, and remediate vulnearbilities associated with implementations. I created an easily deployable docker environment here that can be spun up on a local machine in about 5 minutes. I also have instructions to split the deployment across multiple hosts.\nThis includes a fully functional IDP and a Service Provider. The Service Provider has several configuration options that allow for post deployment on the fly adjustments to the security stance of the application. When its fully deployed the environment will be similar to the architecture and data flows below:\nNot sure what SAML is or looking for a refesher? Check out the saml_overview page.\nBack Story For this scenario we are Yogi Bear. The Jellystone park staff have had enough of our stealing of picnic baskets. In an effort to track this behavior they have setup “Yogi’s Saml App”. This application allows park visitors to file complaints about our behavior.\nOur goal as Yogi is to gain administrative access to the application via SAML implementation errors and delete the complaints. If we fail there is a possibility that we will be relocated to another park with no picnic baskets.\nSetting up the test environment Quick and Easy Deployment The easiest way to get everything up and running is by cloning the repository and then simply running a quick docker-compose command. The compose command will build the images, and deploy them to the local host.\ngit clone https://github.com/yogisec/VulnerableSAMLApp.git cd VulnerableSAMLApp sudo docker-compose up The Service Provider will be listening on http://127.0.0.1:8000. The IDP will be listening at http://127.0.0.1. Head down to the Features section for login details and more information about the applications.\nSplit Host Deployment In order to split the deployment across two seperate hosts (one an IDP, and the other a SP). We need to change some configuration details.\nFirst clone the repository onto both hosts:\ngit clone https://github.com/yogisec/VulnerableSAMLApp.git cd VulnerableSAMLApp On the host that will become the IDP run the configure_platform.py script. Work through the prompts filling in the information as requested to make the necessary edits to the IDP configuration files.\npython3 configure_platform.py If you had the script build the docker container for you run the container with the following command and then skip down to configure the SP:\nsudo docker run -it --rm --name idp -d -p 80:80 idp:1.0 If you did not let the script build the container we need to build it. We can do that with the following command:\ncd vulnerableidp sudo docker build -t idp:1.0 . This will build a container with the name idp and the tag 1.0. Next run the container with:\nsudo docker run -it --rm --name idp -d -p 80:80 idp:1.0 Confirm the container is running by running:\nsudo docker ps If its running we should see an output similar to:\n189adee1b091 localhost/idp:1.0 apache2ctl -D FOR... 2 seconds ago Up 2 seconds ago 0.0.0.0:80-\u003e80/tcp idp We can confirm the IDP is listening by running curl:\ncurl http://127.0.0.1 Next on the Service Provider host run the configure_platform.py script. Work through the prompts filling in the information as requested to make the necessary edits to the application configuration files.\npython3 configure_platform.py If you had the script build the docker container for you run the container with the following command and then skip down to the Features section to learn about the application:\nsudo docker run -it --rm --name sp -d -p 80:80 sp:1.0 If you did not let the script build the container we need to build it. We can do that with the following command:\ncd vulnerablesp sudo docker build -t sp:1.0 . This will build a container with the name sp and the tag 1.0. The next step is to run the container. This can be done with:\nsudo docker run -it --rm --name sp -d -p 8000:8000 sp:1.0 We can confirm the container is running by issuing:\nsudo docker ps This should produce an ouput similar to this:\n94476aee1abf sp:1.1 \"uwsgi --ini vulnsp.…\" 4 minutes ago Up 4 minutes 0.0.0.0:8000-\u003e8000/tcp sp We can confirm the application is up and listening by curling the interface with:\ncurl http://127.0.0.1:8000 At this point the IDP and the SP should be up and running and accessible. The next section will provide an overview of some of the features of the application.\nFeatures of the environment Login credentials:\nUsername Password Description yogi bear Basic user account, memeber of the ‘users’ group. No special permissions admin this-is-the-administrator-pasword-oh-no-is-that-a-typo-in-password Regular administrator account, member of the admin group. This account has the ability to delete the complaints. brubble password This is account was registered specifically for CVE-2017-11427 instructor G0od-LuckGu3ssingThisButHeyItCouldHappenRight? This account is allowed to reset the complain board back to its original state. Additionally this account was the ability to increase or decrease the security posture of the application. After successfully logging in we are presented with our profile as seen by the application. This is a quick and easy way to confirm which user we are, as well as our current group membership.\nThe complaints tab is where all of the complaints are stored and is the overall goal of the application.\nIn the screenshot below we have authenticated with the admin user account and have a new capability to delete complaints.\nThe instructor account has several special features to help maintain order within the application. There is a ‘Restore Complaints’ button on the complaints page that reverts all of the complaints back to the starting state of the application.\nThe instructor account also has a new tab called Saml Settings. Within this tab we can make the application more or less security by checking the features we want to have turned on or off.\nThe Scenarios Setting Description Nothing Configured The application accepts any SAML message, edit away, the application trusts everything. Valid Assertion / Valid Messages The Service Provider is checking for valid assertions, any tampering results in the message being rejected. Unless we remove the signature block. Want Assertions / Messages Signed The Service Provider requires the messages to be signed, but it doesn’t check to see if they are valid signatures. Everything Signed, Everything Valid This is the ideal deployment, messages must be signed and they must be valid, no tampering allowed. CVE-2017-11427 This is an implementation of CVE-2017-11427 which leverages comments within the SAML response XML to bypass security controls. Note: for all of the SAML message tampering below I am leveraging the SAML Raider plugin for burp. It handles the decoding of the messages on the fly and allows for edits. It also supports XSW attacks which are currently beyond the scope of this application.\nAdditional Note: When changing from one scenario to the next it is best to make sure you signed out before adjusting the security levels of the Service Provider (SP). This helps to ensure there are no unforseen outcomes.\nNothing Configured For this scenario we’ll use the security configuration pictured below.\nBefore we get to far into this scenario, I wanted to take a moment and say that this scenario, this configuration issue, is the MOST common implementation flaw that I come across.\nOnce we authenticate to our IDP we can make any changes to the SAML response that we want. The message will not be checked, the SP will simply process it as valid. The screenshot below shows the original assertion before tamper:\nnothing_orig_assertion\nNow, if we change our user group to the administrators group as pictured below we will successfully escalate our privileges from a regular user account to a full admin within the SP.\nnothing_tamper_assertion\nOnce we pass the SAML response payload along to the SP we are now an administrator within the SP and as we can see below when we click on the complaints tab we now have the ability to delete all of the complaints.\nnothing_delete\nWe can even take it a step further if we’d like and replace all of the fields within the response with fake information similar to the picture below. As the SP logs our ‘malicious’ doings it will log all of our fake information. The only true way to determine who we were before changing our use settings would be to sync up the logs from the IDP and the SP to determine who authenticated to the IDP before the malicious activity began.\nnothing_fake\nAbove I mentioned that this configuration is the most common issue that I find when testing SAML implementations. The reason for this is because when most applications are initially configured to leverage saml the check box to make sure messages are secure is left unchecked. This allows the owners to validate that all of the backend configuration that occurs between the SP and the IDP is correctly configured without dealing with certificates. The unfortunate part is most of the time this is where things get left. The messages are left fully vulnerable to anyone who can authenticate to the IDP.\nValid Assertion / Valid Message / Both For this scenario we’ll use the security configuration pictured below. This scenario plays out the exact same way if validMessage is also checked, or if it is checked and validAssertion is not.\nvalid_assertion_config\nOn the surface this seems like the ideal configuration. The Service Provider is checking for valid assertions, any tampering with the assertion attributes results in the message being rejected. In the picture below we have authenticated as the Yogi user account, and our assertion payload includes attributes about our account including our group membership ‘users’.\nvalid_assertion_group\nWe can attempt change the group membership to another group such as the ‘administrators’ group in the photo below.\nvalid_assertion_group_edited\nUnfortunatly as we can see below the message is rejected because its not valid when compared to the signature for the message.\nvalid_assertion\nThere is a big security flaw with this configuration. The SP is only checking that the assertion is valid IF its signed. The application does not have signed messages as a requirement. If we remove the entire signature block from our SAML payload the message can be changed.\nIn the Burp intercept for the web traffic within the SAML raider tab we can click the ‘Remove Signatures’ button to remove the entire signature area of the XML SAML Response.\nsigned_signature_removed\nWhen we attempt to tamper with the SAML response without a signature the SP accepts our resposne and we are now authenticated to the application as a member of the administrators group!\nsigned_success\nWant Assertions / Messages Signed Things are slightly improving with this deployment. With this configuration the Assertion and/or Message must be signed. Since the application requires a signature we cannot just remove the signature block like we did in the previous scenario. To prove all of this out we will use the configuration below:\nsigned_config\nThe first thing we can try is to simply remove the signature elements. We wont tamper with anything, just a quick test to see if we can remove the signatures and have the SAML response still be accepted by the SP.\nsigned_signature_removed\nAs expected with our current configuration settings the SP rejects the response payload because it is invalid.\nsigned_error\nPerhaps we can leave the signature elements in the response message but change the assertion attributes? Below we can see the memberOf attribute value has been changed from the users group to the administrators group.\nsigned_group_change\nSending the response payload along and we are greated with a successful login as well as our new permissions as a member of the administrators group!\nsigned_success\nWhy did that work? The application is checking for signatures isn’t it? Well it is and it isn’t. The application in its current configuration is checking to make sure there are signature attributes within the SAML response and that it is signed with the trusted certificate. It’s not actually checking if they are valid or not. If the signature elements are in the message the application assumes its legitimate and trust worthy.\nSigned and Valid In this scenario we’ll use the following configuration:\nsigned_valid_config\nThis configuration is what is expected when deploying an application leveraging SAMl authentication. In this setup the SP requires that the messages are signed and that the signatures match the data in the overall message and the assertion. This means as an attacker we cannot tamper with the areas of the message which are used to calculate the signatures. This includes the attribute values within the assertion. Let’s try out a couple things and see the outcomes.\nThere is a known bug with this deployment where when the application requires signed messages it will error on an attempt to sign out after a valid log in. The current work around is to either delete the session cookies, or to lower the security settings of the application by removing the requirement for signed messages to complete the log out. In the case of this application leaving the application with a requirement for the Assertions to be signed produces the same effect as also requirin the messages to be signed.\nLets try to remove the signature of the SAML response:\nsigned_signature_removed\nThis results in the error below, because the application is checking to see if the message is signed.\nsigned_valid_errors\nLets leave the signature but change the attribute values within the assertion.\nsigned_group_change\nThis results in another error. This is because the application is configured to make sure the messages are valid if they are signed.\nsigned_valid_errors\nThe next scenario is able to bypass this situation and it does so in a very intersting way.\nCVE-2017-11427 In February of 2018 DUO labs release details about vulnerabilities in 6 libraries that application leverage to use for SAML. This includes the library used as the source for this application. The original article is here.\nAt a high level, you can add a comment in the middle of the XML assertion to change the attributes/values of the SAML response. The really damaging part of this is that depending on the library being used the comment may be ignored during the signature calculation of the message. So to the SP the message is still valid. For this application we’ll need to lower our security settings in order to become vulnerable to this attack. The configuration is below:\ncve_config\nFor this scenario we’ll pivot away from the ‘Yogi’ user account and use the Barney Rubble (brubble) user account. Imagine that Barney is an employee who has ‘power user’ permissions within the Service Provider. He doesn’t have full admin rights so deleting comments isn’t avaialble to him. One of the things that he is allowed to do is create groups! He created a group called ‘administratorsbutnot’ and added his user account to the group. Lets see how the scenario plays out.\nFirst we’ll log in and confirm the group membership is correct, and that as Barney we do not have the ability to delete comments.\nLogin success and correct group membership:\ncve_group\nOn complaints page we do not have access to delete:\ncve_complaints\nNow we will sign out and back in again, this time changing the SAML response to comment out the ‘butnot’ portion of the group membership like this: administrators\ncve_comment\nSuccess! We’ve logged into the application and it looks like we are now a memeber of the administrators group.\ncve_group_admins\nChecking the complaints page we now have the ability to delete comments!\ncve_delete\nOther attacks There are several more types of vulnerabilities that could exist. Message replays, where an attacker sends a message after its TTL has expired.\nXSW attacks which take chunks of the SAML response and duplicate it and place it in various places within the response. In these scenarios the SP checks to see if a valid signed assertion/message/etc. exists and then processes the message. What if there are two assertions, the first valid, and signed but the second is not. Which will the application process? The first, second, last, cause it to crash?\nThe Yogi Vulnerable SP is not yet vulnerable to these attacks, but they’re on the list.\nReferences Great References:\nRFC7522 SAML Overview of SAML Authentication vs Authorization Bypassing SAML 2.0 SSO with XML Signature Attracks Duo Finds SAML Vulnerabilities Affecting Multiple Implementations ","wordCount":"2709","inLanguage":"en","datePublished":"2019-11-28T00:00:00Z","dateModified":"2019-11-28T00:00:00Z","author":{"@type":"Person","name":"Travis"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jellyparks.com/posts/vulnerable-saml-app/"},"publisher":{"@type":"Organization","name":"JellyParks","logo":{"@type":"ImageObject","url":"https://jellyparks.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jellyparks.com accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jellyparks.com/posts title=all_posts><span>all_posts</span></a></li><li><a href=https://jellyparks.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://jellyparks.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://jellyparks.com/me/ title=me><span>me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jellyparks.com>Home</a>&nbsp;»&nbsp;<a href=https://jellyparks.com/posts/>Posts</a></div><h1 class=post-title>Yogi's Vulnerable SAML app</h1><div class=post-meta><span title='2019-11-28 00:00:00 +0000 UTC'>November 28, 2019</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;Travis&nbsp;|&nbsp;<a href=https://github.com/yogisec/yogisec.github.io/blob/main/content/posts/vulnerable-saml-app/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-is-this-thing aria-label="What is this thing?">What is this thing?</a></li><li><a href=#back-story aria-label="Back Story">Back Story</a></li><li><a href=#setting-up-the-test-environment aria-label="Setting up the test environment">Setting up the test environment</a><ul><li><a href=#quick-and-easy-deployment aria-label="Quick and Easy Deployment">Quick and Easy Deployment</a></li><li><a href=#split-host-deployment aria-label="Split Host Deployment">Split Host Deployment</a></li></ul></li><li><a href=#features-of-the-environment aria-label="Features of the environment">Features of the environment</a></li><li><a href=#the-scenarios aria-label="The Scenarios">The Scenarios</a><ul><li><a href=#nothing-configured aria-label="Nothing Configured">Nothing Configured</a></li><li><a href=#valid-assertion--valid-message--both aria-label="Valid Assertion / Valid Message / Both">Valid Assertion / Valid Message / Both</a></li><li><a href=#want-assertions--messages-signed aria-label="Want Assertions / Messages Signed">Want Assertions / Messages Signed</a></li><li><a href=#signed-and-valid aria-label="Signed and Valid">Signed and Valid</a></li><li><a href=#cve-2017-11427 aria-label=CVE-2017-11427>CVE-2017-11427</a></li></ul></li><li><a href=#other-attacks aria-label="Other attacks">Other attacks</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><hr><h3 id=what-is-this-thing>What is this thing?<a hidden class=anchor aria-hidden=true href=#what-is-this-thing>#</a></h3><p>I built this app because I wanted to better understand SAML and I wanted to know how to discover, exploit, and remediate vulnearbilities associated with implementations. I created an easily deployable docker environment <a href=https://github.com/yogisec/VulnerableSAMLApp>here</a> that can be spun up on a local machine in about 5 minutes. I also have instructions to split the deployment across multiple hosts.</p><p>This includes a fully functional IDP and a Service Provider. The Service Provider has several configuration options that allow for post deployment on the fly adjustments to the security stance of the application. When its fully deployed the environment will be similar to the architecture and data flows below:</p><p><img loading=lazy src=images/vuln-saml-environment.png alt=environment title=img-fluid></p><p>Not sure what SAML is or looking for a refesher? Check out the <a href=https://jellyparks.com/web-things/saml-overview.html>saml_overview</a> page.</p><hr><h3 id=back-story>Back Story<a hidden class=anchor aria-hidden=true href=#back-story>#</a></h3><p>For this scenario we are Yogi Bear. The Jellystone park staff have had enough of our stealing of picnic baskets. In an effort to track this behavior they have setup &ldquo;Yogi&rsquo;s Saml App&rdquo;. This application allows park visitors to file complaints about our behavior.</p><p>Our goal as Yogi is to gain administrative access to the application via SAML implementation errors and delete the complaints. If we fail there is a possibility that we will be relocated to another park with no picnic baskets.</p><hr><h3 id=setting-up-the-test-environment>Setting up the test environment<a hidden class=anchor aria-hidden=true href=#setting-up-the-test-environment>#</a></h3><h4 id=quick-and-easy-deployment>Quick and Easy Deployment<a hidden class=anchor aria-hidden=true href=#quick-and-easy-deployment>#</a></h4><p>The easiest way to get everything up and running is by cloning the repository and then simply running a quick docker-compose command. The compose command will build the images, and deploy them to the local host.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/yogisec/VulnerableSAMLApp.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> VulnerableSAMLApp
</span></span><span class=line><span class=cl>sudo docker-compose up
</span></span></code></pre></div><p>The Service Provider will be listening on <code>http://127.0.0.1:8000</code>. The IDP will be listening at <code>http://127.0.0.1</code>. Head down to the <a href=https://jellyparks.com/web-things/vulnerable-saml-app#features>Features</a> section for login details and more information about the applications.</p><h4 id=split-host-deployment>Split Host Deployment<a hidden class=anchor aria-hidden=true href=#split-host-deployment>#</a></h4><p>In order to split the deployment across two seperate hosts (one an IDP, and the other a SP). We need to change some configuration details.</p><p>First clone the repository onto both hosts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/yogisec/VulnerableSAMLApp.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> VulnerableSAMLApp
</span></span></code></pre></div><p>On the host that will become the <code>IDP</code> run the <code>configure_platform.py</code> script. Work through the prompts filling in the information as requested to make the necessary edits to the IDP configuration files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 configure_platform.py
</span></span></code></pre></div><p>If you had the script build the docker container for you run the container with the following command and then skip down to configure the SP:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker run -it --rm --name idp -d -p 80:80 idp:1.0
</span></span></code></pre></div><p>If you did not let the script build the container we need to build it. We can do that with the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> vulnerableidp
</span></span><span class=line><span class=cl>sudo docker build -t idp:1.0 .
</span></span></code></pre></div><p>This will build a container with the name <code>idp</code> and the tag <code>1.0</code>. Next run the container with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker run -it --rm --name idp -d -p 80:80 idp:1.0
</span></span></code></pre></div><p>Confirm the container is running by running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker ps
</span></span></code></pre></div><p>If its running we should see an output similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>189adee1b091 localhost/idp:1.0 apache2ctl -D FOR... <span class=m>2</span> seconds ago Up <span class=m>2</span> seconds ago 0.0.0.0:80-&gt;80/tcp idp
</span></span></code></pre></div><p>We can confirm the IDP is listening by running curl:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://127.0.0.1
</span></span></code></pre></div><p>Next on the <code>Service Provider</code> host run the <code>configure_platform.py</code> script. Work through the prompts filling in the information as requested to make the necessary edits to the application configuration files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 configure_platform.py
</span></span></code></pre></div><p>If you had the script build the docker container for you run the container with the following command and then skip down to the Features section to learn about the application:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker run -it --rm --name sp -d -p 80:80 sp:1.0
</span></span></code></pre></div><p>If you did not let the script build the container we need to build it. We can do that with the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> vulnerablesp
</span></span><span class=line><span class=cl>sudo docker build -t sp:1.0 .
</span></span></code></pre></div><p>This will build a container with the name sp and the tag 1.0. The next step is to run the container. This can be done with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker run -it --rm --name sp -d -p 8000:8000 sp:1.0
</span></span></code></pre></div><p>We can confirm the container is running by issuing:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo docker ps
</span></span></code></pre></div><p>This should produce an ouput similar to this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>94476aee1abf sp:1.1 <span class=s2>&#34;uwsgi --ini vulnsp.…&#34;</span> <span class=m>4</span> minutes ago Up <span class=m>4</span> minutes 0.0.0.0:8000-&gt;8000/tcp sp
</span></span></code></pre></div><p>We can confirm the application is up and listening by curling the interface with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://127.0.0.1:8000
</span></span></code></pre></div><p>At this point the IDP and the SP should be up and running and accessible. The next section will provide an overview of some of the features of the application.</p><hr><h3 id=features-of-the-environment>Features of the environment<a hidden class=anchor aria-hidden=true href=#features-of-the-environment>#</a></h3><p>Login credentials:</p><table><thead><tr><th>Username</th><th>Password</th><th>Description</th></tr></thead><tbody><tr><td>yogi</td><td>bear</td><td>Basic user account, memeber of the &lsquo;users&rsquo; group. No special permissions</td></tr><tr><td>admin</td><td>this-is-the-administrator-pasword-oh-no-is-that-a-typo-in-password</td><td>Regular administrator account, member of the admin group. This account has the ability to delete the complaints.</td></tr><tr><td>brubble</td><td>password</td><td>This is account was registered specifically for CVE-2017-11427</td></tr><tr><td>instructor</td><td>G0od-LuckGu3ssingThisButHeyItCouldHappenRight?</td><td>This account is allowed to reset the complain board back to its original state. Additionally this account was the ability to increase or decrease the security posture of the application.</td></tr></tbody></table><p>After successfully logging in we are presented with our profile as seen by the application. This is a quick and easy way to confirm which user we are, as well as our current group membership.</p><p><img loading=lazy src=images/profile.png alt=profile title=img-fluid></p><p>The complaints tab is where all of the complaints are stored and is the overall goal of the application.</p><p><img loading=lazy src=images/complaints.png alt=complaints title=img-fluid></p><p>In the screenshot below we have authenticated with the admin user account and have a new capability to delete complaints.</p><p><img loading=lazy src=images/delete-complaints.png alt=delete title=img-fluid></p><p>The <code>instructor</code> account has several special features to help maintain order within the application. There is a &lsquo;Restore Complaints&rsquo; button on the complaints page that reverts all of the complaints back to the starting state of the application.</p><p><img loading=lazy src=images/restore-complaints.png alt=restore title=img-fluid></p><p>The instructor account also has a new tab called <code>Saml Settings</code>. Within this tab we can make the application more or less security by checking the features we want to have turned on or off.</p><p><img loading=lazy src=images/settings.png alt=settings title=img-fluid></p><hr><h3 id=the-scenarios>The Scenarios<a hidden class=anchor aria-hidden=true href=#the-scenarios>#</a></h3><table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td>Nothing Configured</td><td>The application accepts any SAML message, edit away, the application trusts everything.</td></tr><tr><td>Valid Assertion / Valid Messages</td><td>The Service Provider is checking for valid assertions, any tampering results in the message being rejected. Unless we remove the signature block.</td></tr><tr><td>Want Assertions / Messages Signed</td><td>The Service Provider requires the messages to be signed, but it doesn&rsquo;t check to see if they are valid signatures.</td></tr><tr><td>Everything Signed, Everything Valid</td><td>This is the ideal deployment, messages must be signed and they must be valid, no tampering allowed.</td></tr><tr><td>CVE-2017-11427</td><td>This is an implementation of CVE-2017-11427 which leverages comments within the SAML response XML to bypass security controls.</td></tr></tbody></table><p>Note: for all of the SAML message tampering below I am leveraging the SAML Raider plugin for burp. It handles the decoding of the messages on the fly and allows for edits. It also supports XSW attacks which are currently beyond the scope of this application.</p><p>Additional Note: When changing from one scenario to the next it is best to make sure you signed out before adjusting the security levels of the Service Provider (SP). This helps to ensure there are no unforseen outcomes.</p><hr><h4 id=nothing-configured>Nothing Configured<a hidden class=anchor aria-hidden=true href=#nothing-configured>#</a></h4><p>For this scenario we&rsquo;ll use the security configuration pictured below.</p><p><img loading=lazy src=images/nothing-config.png alt=nothing_config title=img-fluid></p><p>Before we get to far into this scenario, I wanted to take a moment and say that this scenario, this configuration issue, is the MOST common implementation flaw that I come across.</p><p>Once we authenticate to our IDP we can make any changes to the SAML response that we want. The message will not be checked, the SP will simply process it as valid. The screenshot below shows the original assertion before tamper:</p><p>nothing_orig_assertion</p><p>Now, if we change our user group to the administrators group as pictured below we will successfully escalate our privileges from a regular user account to a full admin within the SP.</p><p>nothing_tamper_assertion</p><p>Once we pass the SAML response payload along to the SP we are now an administrator within the SP and as we can see below when we click on the complaints tab we now have the ability to delete all of the complaints.</p><p>nothing_delete</p><p>We can even take it a step further if we&rsquo;d like and replace all of the fields within the response with fake information similar to the picture below. As the SP logs our &lsquo;malicious&rsquo; doings it will log all of our fake information. The only true way to determine who we were before changing our use settings would be to sync up the logs from the IDP and the SP to determine who authenticated to the IDP before the malicious activity began.</p><p>nothing_fake</p><p>Above I mentioned that this configuration is the most common issue that I find when testing SAML implementations. The reason for this is because when most applications are initially configured to leverage saml the check box to make sure messages are secure is left unchecked. This allows the owners to validate that all of the backend configuration that occurs between the SP and the IDP is correctly configured without dealing with certificates. The unfortunate part is most of the time this is where things get left. The messages are left fully vulnerable to anyone who can authenticate to the IDP.</p><h4 id=valid-assertion--valid-message--both>Valid Assertion / Valid Message / Both<a hidden class=anchor aria-hidden=true href=#valid-assertion--valid-message--both>#</a></h4><p>For this scenario we&rsquo;ll use the security configuration pictured below. This scenario plays out the exact same way if validMessage is also checked, or if it is checked and validAssertion is not.</p><p>valid_assertion_config</p><p>On the surface this seems like the ideal configuration. The Service Provider is checking for valid assertions, any tampering with the assertion attributes results in the message being rejected. In the picture below we have authenticated as the Yogi user account, and our assertion payload includes attributes about our account including our group membership &lsquo;users&rsquo;.</p><p>valid_assertion_group</p><p>We can attempt change the group membership to another group such as the &lsquo;administrators&rsquo; group in the photo below.</p><p>valid_assertion_group_edited</p><p>Unfortunatly as we can see below the message is rejected because its not valid when compared to the signature for the message.</p><p>valid_assertion</p><p>There is a big security flaw with this configuration. The SP is only checking that the assertion is valid IF its signed. The application does not have signed messages as a requirement. If we remove the entire signature block from our SAML payload the message can be changed.</p><p>In the Burp intercept for the web traffic within the SAML raider tab we can click the &lsquo;Remove Signatures&rsquo; button to remove the entire signature area of the XML SAML Response.</p><p>signed_signature_removed</p><p>When we attempt to tamper with the SAML response without a signature the SP accepts our resposne and we are now authenticated to the application as a member of the administrators group!</p><p>signed_success</p><h4 id=want-assertions--messages-signed>Want Assertions / Messages Signed<a hidden class=anchor aria-hidden=true href=#want-assertions--messages-signed>#</a></h4><p>Things are slightly improving with this deployment. With this configuration the Assertion and/or Message must be signed. Since the application requires a signature we cannot just remove the signature block like we did in the previous scenario. To prove all of this out we will use the configuration below:</p><p>signed_config</p><p>The first thing we can try is to simply remove the signature elements. We wont tamper with anything, just a quick test to see if we can remove the signatures and have the SAML response still be accepted by the SP.</p><p>signed_signature_removed</p><p>As expected with our current configuration settings the SP rejects the response payload because it is invalid.</p><p>signed_error</p><p>Perhaps we can leave the signature elements in the response message but change the assertion attributes? Below we can see the memberOf attribute value has been changed from the users group to the administrators group.</p><p>signed_group_change</p><p>Sending the response payload along and we are greated with a successful login as well as our new permissions as a member of the administrators group!</p><p>signed_success</p><p>Why did that work? The application is checking for signatures isn&rsquo;t it? Well it is and it isn&rsquo;t. The application in its current configuration is checking to make sure there are signature attributes within the SAML response and that it is signed with the trusted certificate. It&rsquo;s not actually checking if they are valid or not. If the signature elements are in the message the application assumes its legitimate and trust worthy.</p><h4 id=signed-and-valid>Signed and Valid<a hidden class=anchor aria-hidden=true href=#signed-and-valid>#</a></h4><p>In this scenario we&rsquo;ll use the following configuration:</p><p>signed_valid_config</p><p>This configuration is what is expected when deploying an application leveraging SAMl authentication. In this setup the SP requires that the messages are signed and that the signatures match the data in the overall message and the assertion. This means as an attacker we cannot tamper with the areas of the message which are used to calculate the signatures. This includes the attribute values within the assertion. Let&rsquo;s try out a couple things and see the outcomes.</p><p>There is a known bug with this deployment where when the application requires signed messages it will error on an attempt to sign out after a valid log in. The current work around is to either delete the session cookies, or to lower the security settings of the application by removing the requirement for signed messages to complete the log out. In the case of this application leaving the application with a requirement for the Assertions to be signed produces the same effect as also requirin the messages to be signed.</p><p>Lets try to remove the signature of the SAML response:</p><p>signed_signature_removed</p><p>This results in the error below, because the application is checking to see if the message is signed.</p><p>signed_valid_errors</p><p>Lets leave the signature but change the attribute values within the assertion.</p><p>signed_group_change</p><p>This results in another error. This is because the application is configured to make sure the messages are valid if they are signed.</p><p>signed_valid_errors</p><p>The next scenario is able to bypass this situation and it does so in a very intersting way.</p><h4 id=cve-2017-11427>CVE-2017-11427<a hidden class=anchor aria-hidden=true href=#cve-2017-11427>#</a></h4><p>In February of 2018 DUO labs release details about vulnerabilities in 6 libraries that application leverage to use for SAML. This includes the library used as the source for this application. The original article is here.</p><p>At a high level, you can add a comment in the middle of the XML assertion to change the attributes/values of the SAML response. The really damaging part of this is that depending on the library being used the comment may be ignored during the signature calculation of the message. So to the SP the message is still valid. For this application we&rsquo;ll need to lower our security settings in order to become vulnerable to this attack. The configuration is below:</p><p>cve_config</p><p>For this scenario we&rsquo;ll pivot away from the &lsquo;Yogi&rsquo; user account and use the Barney Rubble (brubble) user account. Imagine that Barney is an employee who has &lsquo;power user&rsquo; permissions within the Service Provider. He doesn&rsquo;t have full admin rights so deleting comments isn&rsquo;t avaialble to him. One of the things that he is allowed to do is create groups! He created a group called &lsquo;administratorsbutnot&rsquo; and added his user account to the group. Lets see how the scenario plays out.</p><p>First we&rsquo;ll log in and confirm the group membership is correct, and that as Barney we do not have the ability to delete comments.</p><p>Login success and correct group membership:</p><p>cve_group</p><p>On complaints page we do not have access to delete:</p><p>cve_complaints</p><p>Now we will sign out and back in again, this time changing the SAML response to comment out the &lsquo;butnot&rsquo; portion of the group membership like this: <code>administrators&lt;!--butnot--></code></p><p>cve_comment</p><p>Success! We&rsquo;ve logged into the application and it looks like we are now a memeber of the administrators group.</p><p>cve_group_admins</p><p>Checking the complaints page we now have the ability to delete comments!</p><p>cve_delete</p><hr><h3 id=other-attacks>Other attacks<a hidden class=anchor aria-hidden=true href=#other-attacks>#</a></h3><p>There are several more types of vulnerabilities that could exist. Message replays, where an attacker sends a message after its TTL has expired.</p><p>XSW attacks which take chunks of the SAML response and duplicate it and place it in various places within the response. In these scenarios the SP checks to see if a valid signed assertion/message/etc. exists and then processes the message. What if there are two assertions, the first valid, and signed but the second is not. Which will the application process? The first, second, last, cause it to crash?</p><p>The Yogi Vulnerable SP is not yet vulnerable to these attacks, but they&rsquo;re on the list.</p><hr><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><p>Great References:</p><ul><li><a href=https://tools.ietf.org/html/rfc7522>RFC7522</a></li><li><a href=https://developer.okta.com/docs/concepts/saml/>SAML</a></li><li><a href=https://developers.onelogin.com/saml>Overview of SAML</a></li><li><a href=https://auth0.com/docs/authorization/concepts/authz-and-authn>Authentication vs Authorization</a></li><li><a href=https://research.aurainfosec.io/bypassing-saml20-SSO/>Bypassing SAML 2.0 SSO with XML Signature Attracks</a></li><li><a href=https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations>Duo Finds SAML Vulnerabilities Affecting Multiple Implementations</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://jellyparks.com/tags/saml/>saml</a></li><li><a href=https://jellyparks.com/tags/identity/>identity</a></li><li><a href=https://jellyparks.com/tags/ctf/>ctf</a></li></ul><nav class=paginav><a class=prev href=https://jellyparks.com/posts/compromised-container-analysis-primer/><span class=title>« Prev Page</span><br><span>compromised_container_analysis_primer</span></a>
<a class=next href=https://jellyparks.com/posts/assumed-role-breadcrumbs/><span class=title>Next Page »</span><br><span>assumed_role_breadcrumbs</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on twitter" href="https://twitter.com/intent/tweet/?text=Yogi%27s%20Vulnerable%20SAML%20app&url=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f&hashtags=saml%2cidentity%2cctf"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f&title=Yogi%27s%20Vulnerable%20SAML%20app&summary=Yogi%27s%20Vulnerable%20SAML%20app&source=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f&title=Yogi%27s%20Vulnerable%20SAML%20app"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on whatsapp" href="https://api.whatsapp.com/send?text=Yogi%27s%20Vulnerable%20SAML%20app%20-%20https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Yogi's Vulnerable SAML app on telegram" href="https://telegram.me/share/url?text=Yogi%27s%20Vulnerable%20SAML%20app&url=https%3a%2f%2fjellyparks.com%2fposts%2fvulnerable-saml-app%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jellyparks.com>JellyParks</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>