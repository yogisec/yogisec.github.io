<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>kubernetes_honeypot_adventures | JellyParks</title><meta name=keywords content="containers,linux,dfir,kubernetes"><meta name=description content="Analysis of a real-world attack captured in a Kubernetes honeypot."><meta name=author content="Travis"><link rel=canonical href=https://jellyparks.com/posts/k8s-honeypot/><link crossorigin=anonymous href=/assets/css/stylesheet.min.9a6093ef6721cb73f74fc97e7e73df4d4e4d54b53acb6508b554b48f5f75b49a.css integrity="sha256-mmCT72chy3P3T8l+fnPfTU5NVLU6y2UItVS0j191tJo=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jellyparks.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://jellyparks.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-13VPCR43BS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-13VPCR43BS",{anonymize_ip:!1})}</script><meta property="og:title" content="kubernetes_honeypot_adventures"><meta property="og:description" content="Analysis of a real-world attack captured in a Kubernetes honeypot."><meta property="og:type" content="article"><meta property="og:url" content="https://jellyparks.com/posts/k8s-honeypot/"><meta property="og:image" content="https://jellyparks.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-03T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-03T00:00:00+00:00"><meta property="og:site_name" content="JellyParks"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jellyparks.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="kubernetes_honeypot_adventures"><meta name=twitter:description content="Analysis of a real-world attack captured in a Kubernetes honeypot."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://jellyparks.com/posts/"},{"@type":"ListItem","position":3,"name":"kubernetes_honeypot_adventures","item":"https://jellyparks.com/posts/k8s-honeypot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"kubernetes_honeypot_adventures","name":"kubernetes_honeypot_adventures","description":"Analysis of a real-world attack captured in a Kubernetes honeypot.","keywords":["containers","linux","dfir","kubernetes"],"articleBody":" Analysis of a real-world attack captured in a Kubernetes honeypot.\nEnvironment High Level For this environment we are analyzing activity which occurred in a Kubernetes (k8s) cluster exposed to the Internet. The k8s api server was configured to allow anonymous access. The anonymous user was granted administrator capabilities within the cluster. This was done to mirror one of the (unfortunately) more commonly occurring misconfigurations which lead to clusters being compromised.\nLogs from the cluster were streamed into a Splunk instance for easy parsing.\nInitial Access This honeypot was configured with one expected route in by a malicious actor. In order to monitor for malicious behavior I start with a simple query looking at any api calls made by the system:anonymous user. It is nothing fancy but does well as an initial hunt to show when something has occurred. In Splunk this is the query:\nindex=k8s sourcetype=kube:apiserver-audit \"user.username\"=\"system:anonymous\" |table _time, userAgent, verb, requestURI, sourceIPs{}, responseStatus.code |sort -_time The attack began at 2022-10-23 12:30:24.602 with a malicious request to list all the secrets in the Kubernetes cluster. The userAgent for this request was python-requests/2.27.1.\nFor those new to Kubernetes, secrets are base64 encoded blobs of data. These blobs are used by the applications running within k8s to store sensitive information (think api keys used to access 3rd party apis, db creds, etc.). Service account tokens are also stored as secrets and used to access resources within the cluster via the k8s api server.\nApproximately seven minutes later (2022-10-23 12:37:31.733) a call to create a clusterrolebinding with the userAgent of curl/7.64.0 was made.\nA clusterrolebinding is a k8s object which ties a role (object which defines permission boundaries) and a service account together.\nThe request to create the clusterrolebinding is below:\nLooking at the request under the objectRef section we can see the clusterrolebinding which was created was named kube-controller-manager. We know the request was successful because under the responseStatus section we can see the code: 201. The verb for this request is create which tells us that the malicious actor is creating a new resource.\nIf we trust the UserAgent field and this request was generated with curl it would look something similar to:\ncurl -k -X Post https://k8s-api-server/api/rbac.authorization.k8s.io/v1/clusterrolebindings -d @data.yml Due to a limitation of the logging configuration I was unable to capture the configuration yaml for the clusterrolebinding when the request came in. This would have shown the role and service account which were tied together. The next iteration of this honeypot will remediate this issue as I increase the logging around clusterrolbinding objects. Take this as a lesson to ensure your own production logs are configured in a way that will be useful during an investigation. Ultimately for this attack it did not really matter.\nAttempting to view the clusterrolebinding also fails because it had been deleted by the time analysis occurred:\nk get clusterrolebinding kube-controller-manager Error from server (NotFound): clusterrolebindings.rbac.authorization.k8s.io \"kube-controller-manager\" not found Throughout the log files the authorization.k8s.io/reason field shows the default user in the kube-system namespace had the ability to utilize the cluster-admin role via the kube-controller-manager clusterrolebinding. Based on these messages we can infer the missing request to create the clusterrolebinding looked something similar to:\n\"kind\": \"ClusterRoleBinding\", \"apiVersion\": \"rbac.authorization.k8s.io/v1\", \"metadata\": { \"name\": \"kube-controller-manager\", }, \"subjects\": [ { \"kind\": \"ServiceAccount\", \"name\": \"default\", \"namespace\": \"kube-system\" } ], \"roleRef\": { \"apiGroup\": \"rbac.authorization.k8s.io\", \"kind\": \"ClusterRole\", \"name\": \"kube-admin\" } It is possible other subjects could have been defined in addition to the kube-system default service account, however there was no evidence of this behavior.\nTen seconds after the clusterrolebinding request at 2022-10-23 12:37:41.482 another request came through listing secrets in the kube-system namespace. This request was made to get authentication details stored in secrets in the kube-system namespace.\nUsing curl the attacker would have utilized something similar to:\ncurl -k https://k8s-api-server/api/v1/namespaces/kube-system/secrets At this point the malicious actor had new credentials to access the cluster. With them they move on to the next phase of the attack.\nRemoving the Competition To follow the activity of the new service account I adjusted the Splunk search to the following:\nindex=k8s sourcetype=kube:apiserver-audit user.username=system:serviceaccount:kube-system:default |table _time, user.username, userAgent, verb, requestURI, responseStatus.code |sort -_time After getting credentials the attacker pivots from (what we’re presuming is) curl to using kubectl. At 2022-10-23 12:37:51.281 we see a series of 32 requests all within a second of each other. Each request had a timeout=32s at the end. These are all the results of running the command: kubectl api-resources. This command lists all the api-resources available on a cluster. More research needs to be done here, but I believe kubectl makes this call behind the scenes periodically.\nAfter those events a series of delete requests were sent starting at 2022-10-23 12:37:53.339. Looking at the requestURI field we can see there is a request to delete a deployment in the default namespace called worker-deployment, another request to delete a deployment called api-proxy in the kube-system namespace, and finally a request to delete a pod running in the default namespace called kube-secure-fhgxtsjh.\nThese all returned 404 response codes because they are resources which did not exist in the cluster. I expect this was an attempt to remove competition who may also exist on the cluster already. It could also be an attempt to clean up a possible existing foothold created via some other means that were not relevant to this attack.\nAssuming kubectl was used to generate these events the following commands were issued:\nkubectl delete deployment worker-deployment -n default kubectl delete deployment api-proxy -n kube-system kubectl delete pod kube-secure-fhgxtsjh - default The last delete command is interesting because it was a single one-off pod the attacker was looking for, but it is named in a way to blend in as if it were a part of a deployment/daemonset. Perhaps future honeypots will reveal what these resources are.\nDirectly after attempting to delete the resources above, we see a request at 2022-10-23 12:38:10.451 to check for a daemonset called kube-controller in the kube-system namespace.\nDaemonsets are objects in k8s that instruct k8s to deploy a copy of the pod to every single node in the cluster. A lot of monitoring and security tools will be deployed via daemonsets to ensure complete cluster visibility.\nA 404 response was returned indicating that the daemonset kube-controller did not exist. Two seconds later at 2022-10-23 12:38:12.762 another call was issued to check for the kube-system namespace. This seemed odd since earlier the attacker was already interacting with the namespace. Perhaps they wanted to re-validate it existed, or they wanted something out of the raw response. At 2022-10-23 12:38:19.830 the same two requests come through again.\nAfter these requests the malicious actor moves on to the next phase of the attack.\nActions on Objectives Now that the cluster has been cleaned up of any unwanted deployments or pods the attacker moved on to deploying a daemonset. At 2022-10-23 12:38:21.132 there was a create request issued to create a daemonset in the kube-system namespace.\nA few seconds later a follow-up request was made to check the status of the newly created object. In the picture below we can see the full response from the api server for the create request.\nUnder the objectRef section we can see the name of the daemonset is kube-controller, and confirm the namespace is kube-system. The resposne code of 201 indicates the request was successful. Once again the username who made the request is system:serviceaccount:kube-system:default. By looking at the authorization.k8s.io.reason we can tell that the service account is associated with a clusterrolbinding granting access to the cluster-admin role.\nAt the time of analysis, the daemonset still existed. We can see in the output below the kube-controller daemonset was created 5 days and 21 hours ago, and currently has 2 pods ready and available.\nk get ds -n kube-system NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE kube-controller 2 2 2 2 2 5d21h By requesting the details of the daemonset we can get the yaml definition file below:\nkubectl get ds kube-controller -n kube-system -o yaml apiVersion: apps/v1 kind: DaemonSet metadata: annotations: deprecated.daemonset.template.generation: \"1\" kubectl.kubernetes.io/last-applied-configuration: | {\"apiVersion\":\"apps/v1\",\"kind\":\"DaemonSet\",\"metadata\":{\"annotations\":{},\"labels\":{\"app\":\"kube-controller\"},\"name\":\"kube-controller\",\"namespace\":\"kube-system\"},\"spec\":{\"selector\":{\"matchLabels\":{\"app\":\"kube-controller\"}},\"template\":{\"metadata\":{\"labels\":{\"app\":\"kube-controller\"}},\"spec\":{\"containers\":[{\"image\":\"kubrnetesio/kube-controller:1.0.1\",\"imagePullPolicy\":\"IfNotPresent\",\"name\":\"kube-controller\"}],\"tolerations\":[{\"operator\":\"Exists\"}]}}}} creationTimestamp: \"2022-10-23T17:38:21Z\" generation: 1 labels: app: kube-controller name: kube-controller namespace: kube-system resourceVersion: \"593374\" uid: c0a58c6e-be4b-46d9-83fc-d997ba99d55d spec: revisionHistoryLimit: 10 selector: matchLabels: app: kube-controller template: metadata: creationTimestamp: null labels: app: kube-controller spec: containers: - image: kubrnetesio/kube-controller:1.0.1 imagePullPolicy: IfNotPresent name: kube-controller resources: {} terminationMessagePath: /dev/termination-log terminationMessagePolicy: File dnsPolicy: ClusterFirst restartPolicy: Always schedulerName: default-scheduler securityContext: {} terminationGracePeriodSeconds: 30 tolerations: - operator: Exists updateStrategy: rollingUpdate: maxSurge: 0 maxUnavailable: 1 type: RollingUpdate status: currentNumberScheduled: 2 desiredNumberScheduled: 2 numberAvailable: 2 numberMisscheduled: 0 numberReady: 2 observedGeneration: 1 updatedNumberScheduled: 2 This definition file is extremely helpful. There are no volumes or extra permissions granted to the pod which means no container escapes were attempted (more than likely kernel exploits are still a possibility). We can also see the image that is used kubrnetesio/kube-controller:1.0.1. At first glance it may look like a legitimate image, but kubrnetesio is a typo squat on kubernetes. We will dive deeper into this image later, for now we will continue to build out the timeline of events using the k8s api audit logs a bit more.\nCleaning Up 10 seconds after validating the daemonset was up the attacker begins to cleanup and harden the cluster from further attack. At 2022-10-23 12:39:40.748 a request was made to delete the clusterrolebinding for cluster-system-anonymous. This effectively prevents anyone else from connecting to the cluster without authentication.\nUsing kubectl the command would look something similar to:\nkubectl delete clusterrolebinding cluster-system-anonymous Next, two more commands came in a few seconds later. The first was to delete a daemonset api-proxy in the kube-system namespace and another to delete the clusterrolebinding kube-controller-manager created for this attack.\nThe attacker issued a few more commands but they all fail because they have deleted the clusterrolebinding and have effectivly locked themselves out of the cluster as well. The only exception is the daemonset they created which could be a foothold into the cluster.\nFor a complete timeline of the attack check out the ‘Complete Timeline of the Attack’ section at the bottom of the page.\nProcess Analysis To determine the process(s) associated with the malicious pods we first needed to determine a container id on the host. The kubectl command below revealed the pod name as well as the host where the container was running.\nkubectl get pods -n kube-system -o wide NAME READY STATUS RESTARTS AGE IP NODE kube-controller-cq8f8 1/1 Running 0 4d5h 100.96.2.4 ip-172-20-45-237.ec2.internal kube-controller-m2gjc 1/1 Running 0 6d20h 100.96.1.14 ip-172-20-49-244.ec2.internal Pushing deeper we can query the details for one of the pods and determine a containerid associated with it:\nkubectl get pod kube-controller-cq8f8 -o yaml |grep -i containerid Containerid: 643747d8420547509c2a80f791ef139647fbce9df53478530f9d1e217f1eb982 On the host itself running pstree and searching for the container id the results below were retirmed showing the process of the container was 6340. The only process running in the container was pid 6554, and everything under it was a thread of the process.\nKnowing this, the running kube-controller binary was copied out of the proc folder with cp /proc/6554/exe /tmp/6554 and analysis of the binary began.\nDuring initial analysis attempting to determine if the binary was packed (it’s not) the binary showed signs of being an unpacked coin miner.\nTo further confirm the binary was a coin miner (or at least some part of it was) strings was ran searching for xmrig.\nThe results output confirmed this was a coin miner. For further corroboration VirusTotal also returned results on this binary being a coin miner.\nNetwork connections for the process were also inspected but did not point to anything interesting. Periodically the outbound established ip address would rotate. All observed outbound connections were made to addresses hosted in aws. The network traffic was all encrypted. At this point diving deeper into the network traffic did not seem necessary.\nImage Analysis Carving out the image and viewing it layer by layer helped to confirm what was learned when conducting analysis of the process. There are three layers in this image. The first was the base image used by the attacker to add malicious components to and appears to be an alpine linux image.\nThe second layer was the result of the COPY command moving the kube-controller binary into the image.\nThe third image shows a file .xmrig.json being copied into the image in roots home folder.\nBased on the layer information and the information observed in the daemonset definition file we can infer the Dockerfile for this image would look something similar to:\nfrom alpine:3.13.1 COPY ./kube-controller /kube-controller COPY ./xmrig.json /root/.xmrig.json RUN chmod 755 /kube-controller ENTRYPOINT [\"/kube-controller\"] After extracting the layers, we can access the json config file for xmrig and get the wallet id as well as other information.\nOn docker hub this image had been pulled over 10,000 times.\nThe image no longer exists on dockerhub and the entire kubrnetesio account has been removed.\nPrevention To prevent this there are a few different things that can be done:\nDon’t allow anonymous access Don’t expose the api server to the entire Internet Only allow signed trusted images to run on the cluster Build alerts for successful anonymous access. These can be written in a SIEM or via a runtime agent running in the cluster such as Falco. Build alerts for cluster-admin binds. Just like the previous entry the SIEM or something such as Falco or osquery can be utilized here. Make sure your cluster is up to date. Initially I ran this honeypot on the current release of Kubernetes, but the attacks would stop after creating the clusterrolebinding and attempting to query for the service account token. As of Kubernetes 1.24 service account tokens are no longer automatically generated, and they must be manually generated. This group of malicious actors have yet to take this into consideration so their attacks fail despite the anonymous user having full admin permissions on the cluster. Complete Timeline of the Attack Event Time username userAgent verb requestURI Response Code 2022-10-23 12:30:24.602 system:anonymous python-requests/2.27.1 list /api/v1/secrets/ 200 2022-10-23 12:37:31.733 system:anonymous curl/7.64.0 create /apis/rbac.authorization.k8s.io/v1/clusterrolebindings 201 2022-10-23 12:37:41.482 system:anonymous curl/7.64.0 list /api/v1/namespaces/kube-system/secrets 200 2022-10-23 12:37:48.033 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /api?timeout=32s 200 2022-10-23 12:37:49.447 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis?timeout=32s 200 2022-10-23 12:37:51.119 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/autoscaling/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/events.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/authentication.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apiregistration.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apps/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/storage.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/certificates.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.281 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/flowcontrol.apiserver.k8s.io/v1beta1?timeout=32s 200 2022-10-23 12:37:51.848 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /api/v1?timeout=32s 200 2022-10-23 12:37:51.859 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/events.k8s.io/v1beta1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/autoscaling/v2?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/batch/v1beta1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/policy/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/node.k8s.io/v1beta1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/authorization.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/storage.k8s.io/v1beta1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apiextensions.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/rbac.authorization.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/node.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/networking.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/policy/v1beta1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/discovery.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:51.969 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/autoscaling/v2beta1?timeout=32s 200 2022-10-23 12:37:52.062 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/admissionregistration.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:52.062 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/scheduling.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:52.062 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/autoscaling/v2beta2?timeout=32s 200 2022-10-23 12:37:52.154 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/discovery.k8s.io/v1beta1?timeout=32s 200 2022-10-23 12:37:52.155 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/flowcontrol.apiserver.k8s.io/v1beta2?timeout=32s 200 2022-10-23 12:37:52.155 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/batch/v1?timeout=32s 200 2022-10-23 12:37:52.155 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/coordination.k8s.io/v1?timeout=32s 200 2022-10-23 12:37:53.339 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/apps/v1/namespaces/default/deployments/worker-deployment 404 2022-10-23 12:37:57.898 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/apps/v1/namespaces/kube-system/deployments/api-proxy 404 2022-10-23 12:38:01.766 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /api/v1/namespaces/default/pods/kube-secure-fhgxtsjh 404 2022-10-23 12:38:06.067 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /api/v1/namespaces/default/pods/kube-secure-fhgxt 404 2022-10-23 12:38:10.451 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller 404 2022-10-23 12:38:12.762 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /api/v1/namespaces/kube-system 200 2022-10-23 12:38:16.765 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /openapi/v2?timeout=32s 200 2022-10-23 12:38:19.830 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller 404 2022-10-23 12:38:20.495 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /api/v1/namespaces/kube-system 200 2022-10-23 12:38:21.132 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab create /apis/apps/v1/namespaces/kube-system/daemonsets?fieldManager=kubectl-client-side-apply\u0026fieldValidation=Strict 201 2022-10-23 12:38:30.085 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab get /apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller 200 2022-10-23 12:39:15.761 system:anonymous curl/7.64.0 list /api/v1/namespaces/kube-system/secrets 200 2022-10-23 12:39:40.748 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/rbac.authorization.k8s.io/v1/clusterrolebindings/cluster-system-anonymous?timeout=10s 200 2022-10-23 12:39:42.343 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/apps/v1/namespaces/kube-sytem/daemonsets/api-proxy?timeout=10s 404 2022-10-23 12:39:46.760 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/rbac.authorization.k8s.io/v1/clusterrolebindings/kube-controller-manager?timeout=10s 200 2022-10-23 12:39:49.713 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/rbac.authorization.k8s.io/v1/clusterrolebindings?fieldSelector=metadata.name%3Dkube-controller-manager\u0026timeout=10s 403 2022-10-23 12:40:01.102 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /api/v1/namespaces/default/pods/kube-secure-fhgxtsjh?timeout=10s 403 2022-10-23 12:40:08.544 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /api/v1/namespaces/default/pods/kube-secure-fhgxt?timeout=10s 403 2022-10-23 12:40:12.611 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab delete /apis/rbac.authorization.k8s.io/v1/clusterrolebindings/eks-admin?timeout=10s 403 2022-10-23 12:40:18.294 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/secrets?limit=500\u0026timeout=10s 403 2022-10-23 12:40:24.705 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/pods?limit=500\u0026timeout=10s 403 2022-10-23 12:40:33.352 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/configmaps?limit=500\u0026timeout=10s 403 2022-10-23 12:40:42.762 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/networking.k8s.io/v1/ingresses?limit=500\u0026timeout=10s 403 2022-10-23 12:40:51.379 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/rbac.authorization.k8s.io/v1/clusterroles?limit=500\u0026timeout=10s 403 2022-10-23 12:40:55.609 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/rbac.authorization.k8s.io/v1/clusterrolebindings?limit=500\u0026timeout=10s 403 2022-10-23 12:41:03.747 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/rbac.authorization.k8s.io/v1/roles?limit=500\u0026timeout=10s 403 2022-10-23 12:41:07.045 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /apis/rbac.authorization.k8s.io/v1/rolebindings?limit=500\u0026timeout=10s 403 2022-10-23 12:41:11.267 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/services?limit=500\u0026timeout=10s 403 2022-10-23 12:41:15.285 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/serviceaccounts?limit=500\u0026timeout=10s 403 2022-10-23 12:41:19.253 system:serviceaccount:kube-system:default kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab list /api/v1/nodes?limit=500\u0026timeout=10s 403 ","wordCount":"2898","inLanguage":"en","datePublished":"2022-11-03T00:00:00Z","dateModified":"2022-11-03T00:00:00Z","author":{"@type":"Person","name":"Travis"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jellyparks.com/posts/k8s-honeypot/"},"publisher":{"@type":"Organization","name":"JellyParks","logo":{"@type":"ImageObject","url":"https://jellyparks.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jellyparks.com accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jellyparks.com/posts title=all_posts><span>all_posts</span></a></li><li><a href=https://jellyparks.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://jellyparks.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://jellyparks.com/me/ title=me><span>me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jellyparks.com>Home</a>&nbsp;»&nbsp;<a href=https://jellyparks.com/posts/>Posts</a></div><h1 class=post-title>kubernetes_honeypot_adventures</h1><div class=post-meta><span title='2022-11-03 00:00:00 +0000 UTC'>November 3, 2022</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Travis&nbsp;|&nbsp;<a href=https://github.com/yogisec/yogisec.github.io/blob/main/content/posts/k8s-honeypot/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#environment-high-level aria-label="Environment High Level">Environment High Level</a></li><li><a href=#initial-access aria-label="Initial Access">Initial Access</a></li><li><a href=#removing-the-competition aria-label="Removing the Competition">Removing the Competition</a></li><li><a href=#actions-on-objectives aria-label="Actions on Objectives">Actions on Objectives</a></li><li><a href=#cleaning-up aria-label="Cleaning Up">Cleaning Up</a></li><li><a href=#process-analysis aria-label="Process Analysis">Process Analysis</a></li><li><a href=#image-analysis aria-label="Image Analysis">Image Analysis</a></li><li><a href=#prevention aria-label=Prevention>Prevention</a></li><li><a href=#complete-timeline-of-the-attack aria-label="Complete Timeline of the Attack">Complete Timeline of the Attack</a></li></ul></div></details></div><div class=post-content><hr><p>Analysis of a real-world attack captured in a Kubernetes honeypot.</p><hr><h3 id=environment-high-level>Environment High Level<a hidden class=anchor aria-hidden=true href=#environment-high-level>#</a></h3><p>For this environment we are analyzing activity which occurred in a Kubernetes (k8s) cluster exposed to the Internet. The k8s api server was configured to allow anonymous access. The anonymous user was granted administrator capabilities within the cluster. This was done to mirror one of the (unfortunately) more commonly occurring misconfigurations which lead to clusters being compromised.</p><p>Logs from the cluster were streamed into a Splunk instance for easy parsing.</p><hr><h3 id=initial-access>Initial Access<a hidden class=anchor aria-hidden=true href=#initial-access>#</a></h3><p>This honeypot was configured with one expected route in by a malicious actor. In order to monitor for malicious behavior I start with a simple query looking at any api calls made by the <code>system:anonymous</code> user. It is nothing fancy but does well as an initial hunt to show when something has occurred. In Splunk this is the query:</p><pre tabindex=0><code class=language-spl data-lang=spl>index=k8s sourcetype=kube:apiserver-audit  &#34;user.username&#34;=&#34;system:anonymous&#34; |table _time, userAgent, verb, requestURI, sourceIPs{}, responseStatus.code
|sort -_time
</code></pre><p>The attack began at <code>2022-10-23 12:30:24.602</code> with a malicious request to list all the secrets in the Kubernetes cluster. The userAgent for this request was <code>python-requests/2.27.1</code>.</p><blockquote><p>For those new to Kubernetes, secrets are base64 encoded blobs of data. These blobs are used by the applications running within k8s to store sensitive information (think api keys used to access 3rd party apis, db creds, etc.). Service account tokens are also stored as secrets and used to access resources within the cluster via the k8s api server.</p></blockquote><p>Approximately seven minutes later (<code>2022-10-23 12:37:31.733</code>) a call to create a clusterrolebinding with the userAgent of <code>curl/7.64.0</code> was made.</p><blockquote><p>A clusterrolebinding is a k8s object which ties a role (object which defines permission boundaries) and a service account together.</p></blockquote><p>The request to create the clusterrolebinding is below:</p><p><img loading=lazy src=images/clusterrolebinding.png alt=clusterrolebinding.png title=clusterrolebinding></p><p>Looking at the request under the <code>objectRef</code> section we can see the clusterrolebinding which was created was named <code>kube-controller-manager</code>. We know the request was successful because under the <code>responseStatus</code> section we can see the <code>code: 201</code>. The <code>verb</code> for this request is <code>create</code> which tells us that the malicious actor is creating a new resource.</p><p>If we trust the UserAgent field and this request was generated with curl it would look something similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -k -X Post https://k8s-api-server/api/rbac.authorization.k8s.io/v1/clusterrolebindings -d @data.yml
</span></span></code></pre></div><blockquote><p>Due to a limitation of the logging configuration I was unable to capture the configuration yaml for the clusterrolebinding when the request came in. This would have shown the role and service account which were tied together. The next iteration of this honeypot will remediate this issue as I increase the logging around clusterrolbinding objects. Take this as a lesson to ensure your own production logs are configured in a way that will be useful during an investigation. Ultimately for this attack it did not really matter.</p></blockquote><p>Attempting to view the clusterrolebinding also fails because it had been deleted by the time analysis occurred:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>k get clusterrolebinding kube-controller-manager
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Error from server <span class=o>(</span>NotFound<span class=o>)</span>: clusterrolebindings.rbac.authorization.k8s.io <span class=s2>&#34;kube-controller-manager&#34;</span> not found
</span></span></code></pre></div><p>Throughout the log files the <code>authorization.k8s.io/reason</code> field shows the <code>default</code> user in the kube-system namespace had the ability to utilize the <code>cluster-admin</code> role via the <code>kube-controller-manager</code> clusterrolebinding. Based on these messages we can infer the missing request to create the clusterrolebinding looked something similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;kind&#34;</span><span class=err>:</span> <span class=s2>&#34;ClusterRoleBinding&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;apiVersion&#34;</span><span class=err>:</span> <span class=s2>&#34;rbac.authorization.k8s.io/v1&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;metadata&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;kube-controller-manager&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;subjects&#34;</span><span class=err>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;ServiceAccount&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;default&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;namespace&#34;</span><span class=p>:</span> <span class=s2>&#34;kube-system&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span><span class=err>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;roleRef&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;apiGroup&#34;</span><span class=p>:</span> <span class=s2>&#34;rbac.authorization.k8s.io&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;kind&#34;</span><span class=p>:</span> <span class=s2>&#34;ClusterRole&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;kube-admin&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span></code></pre></div><p>It is possible other subjects could have been defined in addition to the kube-system default service account, however there was no evidence of this behavior.</p><p>Ten seconds after the clusterrolebinding request at <code>2022-10-23 12:37:41.482</code> another request came through listing secrets in the kube-system namespace. This request was made to get authentication details stored in secrets in the kube-system namespace.</p><p><img loading=lazy src=images/anonlistsecrets2.png alt=anonlistsecrets2.png title=listsecrets></p><p>Using curl the attacker would have utilized something similar to:</p><pre tabindex=0><code>curl -k https://k8s-api-server/api/v1/namespaces/kube-system/secrets
</code></pre><p>At this point the malicious actor had new credentials to access the cluster. With them they move on to the next phase of the attack.</p><hr><h3 id=removing-the-competition>Removing the Competition<a hidden class=anchor aria-hidden=true href=#removing-the-competition>#</a></h3><p>To follow the activity of the new service account I adjusted the Splunk search to the following:</p><pre tabindex=0><code>index=k8s sourcetype=kube:apiserver-audit user.username=system:serviceaccount:kube-system:default |table _time, user.username, userAgent, verb, requestURI, responseStatus.code
|sort -_time
</code></pre><p>After getting credentials the attacker pivots from (what we&rsquo;re presuming is) curl to using <code>kubectl</code>. At <code>2022-10-23 12:37:51.281</code> we see a series of 32 requests all within a second of each other. Each request had a <code>timeout=32s</code> at the end. These are all the results of running the command: <code>kubectl api-resources</code>. This command lists all the api-resources available on a cluster. More research needs to be done here, but I believe <code>kubectl</code> makes this call behind the scenes periodically.</p><p>After those events a series of <code>delete</code> requests were sent starting at <code>2022-10-23 12:37:53.339</code>. Looking at the requestURI field we can see there is a request to delete a deployment in the <code>default</code> namespace called <code>worker-deployment</code>, another request to delete a deployment called <code>api-proxy</code> in the <code>kube-system</code> namespace, and finally a request to delete a pod running in the <code>default</code> namespace called <code>kube-secure-fhgxtsjh</code>.</p><p><img loading=lazy src=images/delete1.png alt=delete1.png title=delete></p><p>These all returned 404 response codes because they are resources which did not exist in the cluster. I expect this was an attempt to remove competition who may also exist on the cluster already. It could also be an attempt to clean up a possible existing foothold created via some other means that were not relevant to this attack.</p><p>Assuming <code>kubectl</code> was used to generate these events the following commands were issued:</p><pre tabindex=0><code>kubectl delete deployment worker-deployment -n default
kubectl delete deployment api-proxy -n kube-system
kubectl delete pod kube-secure-fhgxtsjh - default
</code></pre><p>The last delete command is interesting because it was a single one-off pod the attacker was looking for, but it is named in a way to blend in as if it were a part of a deployment/daemonset. Perhaps future honeypots will reveal what these resources are.</p><p>Directly after attempting to delete the resources above, we see a request at <code>2022-10-23 12:38:10.451</code> to check for a daemonset called <code>kube-controller</code> in the <code>kube-system</code> namespace.</p><p><img loading=lazy src=images/validate.png alt=validate.png title=validation></p><blockquote><p>Daemonsets are objects in k8s that instruct k8s to deploy a copy of the pod to every single node in the cluster. A lot of monitoring and security tools will be deployed via daemonsets to ensure complete cluster visibility.</p></blockquote><p>A 404 response was returned indicating that the daemonset <code>kube-controller</code> did not exist. Two seconds later at <code>2022-10-23 12:38:12.762</code> another call was issued to check for the <code>kube-system</code> namespace. This seemed odd since earlier the attacker was already interacting with the namespace. Perhaps they wanted to re-validate it existed, or they wanted something out of the raw response. At <code>2022-10-23 12:38:19.830</code> the same two requests come through again.</p><p>After these requests the malicious actor moves on to the next phase of the attack.</p><hr><h3 id=actions-on-objectives>Actions on Objectives<a hidden class=anchor aria-hidden=true href=#actions-on-objectives>#</a></h3><p>Now that the cluster has been cleaned up of any unwanted deployments or pods the attacker moved on to deploying a daemonset. At <code>2022-10-23 12:38:21.132</code> there was a <code>create</code> request issued to create a daemonset in the kube-system namespace.</p><p><img loading=lazy src=images/money.png alt=money.png title=money></p><p>A few seconds later a follow-up request was made to check the status of the newly created object. In the picture below we can see the full response from the api server for the create request.</p><p><img loading=lazy src=images/daemonsetrequest.png alt=daemonsetrequest.png title=daemonset></p><p>Under the <code>objectRef</code> section we can see the name of the daemonset is <code>kube-controller</code>, and confirm the namespace is <code>kube-system</code>. The resposne code of <code>201</code> indicates the request was successful. Once again the username who made the request is <code>system:serviceaccount:kube-system:default</code>. By looking at the authorization.k8s.io.reason we can tell that the service account is associated with a clusterrolbinding granting access to the <code>cluster-admin</code> role.</p><p>At the time of analysis, the daemonset still existed. We can see in the output below the kube-controller daemonset was created 5 days and 21 hours ago, and currently has 2 pods ready and available.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>k get ds -n kube-system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME              DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
</span></span><span class=line><span class=cl>kube-controller   <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           &lt;none&gt;                   5d21h
</span></span></code></pre></div><p>By requesting the details of the daemonset we can get the yaml definition file below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=l>kubectl get ds kube-controller -n kube-system -o yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>DaemonSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>deprecated.daemonset.template.generation</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kubectl.kubernetes.io/last-applied-configuration</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      </span><span class=w>      </span>{<span class=s2>&#34;apiVersion&#34;</span><span class=p>:</span><span class=s2>&#34;apps/v1&#34;</span><span class=p>,</span><span class=s2>&#34;kind&#34;</span><span class=p>:</span><span class=s2>&#34;DaemonSet&#34;</span><span class=p>,</span><span class=s2>&#34;metadata&#34;</span><span class=p>:</span>{<span class=s2>&#34;annotations&#34;</span><span class=p>:</span>{}<span class=p>,</span><span class=s2>&#34;labels&#34;</span><span class=p>:</span>{<span class=s2>&#34;app&#34;</span><span class=p>:</span><span class=s2>&#34;kube-controller&#34;</span>}<span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;kube-controller&#34;</span><span class=p>,</span><span class=s2>&#34;namespace&#34;</span><span class=p>:</span><span class=s2>&#34;kube-system&#34;</span>}<span class=p>,</span><span class=s2>&#34;spec&#34;</span><span class=p>:</span>{<span class=s2>&#34;selector&#34;</span><span class=p>:</span>{<span class=s2>&#34;matchLabels&#34;</span><span class=p>:</span>{<span class=s2>&#34;app&#34;</span><span class=p>:</span><span class=s2>&#34;kube-controller&#34;</span>}}<span class=p>,</span><span class=s2>&#34;template&#34;</span><span class=p>:</span>{<span class=s2>&#34;metadata&#34;</span><span class=p>:</span>{<span class=s2>&#34;labels&#34;</span><span class=p>:</span>{<span class=s2>&#34;app&#34;</span><span class=p>:</span><span class=s2>&#34;kube-controller&#34;</span>}}<span class=p>,</span><span class=s2>&#34;spec&#34;</span><span class=p>:</span>{<span class=s2>&#34;containers&#34;</span><span class=p>:[</span>{<span class=s2>&#34;image&#34;</span><span class=p>:</span><span class=s2>&#34;kubrnetesio/kube-controller:1.0.1&#34;</span><span class=p>,</span><span class=s2>&#34;imagePullPolicy&#34;</span><span class=p>:</span><span class=s2>&#34;IfNotPresent&#34;</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;kube-controller&#34;</span>}<span class=p>],</span><span class=s2>&#34;tolerations&#34;</span><span class=p>:[</span>{<span class=s2>&#34;operator&#34;</span><span class=p>:</span><span class=s2>&#34;Exists&#34;</span>}<span class=p>]</span>}}}}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2022-10-23T17:38:21Z&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>generation</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kube-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kube-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>kube-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourceVersion</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;593374&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>uid</span><span class=p>:</span><span class=w> </span><span class=l>c0a58c6e-be4b-46d9-83fc-d997ba99d55d</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>revisionHistoryLimit</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kube-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>kube-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>kubrnetesio/kube-controller:1.0.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>IfNotPresent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kube-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>terminationMessagePath</span><span class=p>:</span><span class=w> </span><span class=l>/dev/termination-log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>terminationMessagePolicy</span><span class=p>:</span><span class=w> </span><span class=l>File</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>ClusterFirst</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>schedulerName</span><span class=p>:</span><span class=w> </span><span class=l>default-scheduler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>securityContext</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>terminationGracePeriodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tolerations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>Exists</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>updateStrategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rollingUpdate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>maxSurge</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>maxUnavailable</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>currentNumberScheduled</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>desiredNumberScheduled</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>numberAvailable</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>numberMisscheduled</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>numberReady</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>observedGeneration</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>updatedNumberScheduled</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span></code></pre></div><p>This definition file is extremely helpful. There are no volumes or extra permissions granted to the pod which means no container escapes were attempted (more than likely kernel exploits are still a possibility). We can also see the image that is used <code>kubrnetesio/kube-controller:1.0.1</code>. At first glance it may look like a legitimate image, but <code>kubrnetesio</code> is a typo squat on kubernetes. We will dive deeper into this image later, for now we will continue to build out the timeline of events using the k8s api audit logs a bit more.</p><hr><h3 id=cleaning-up>Cleaning Up<a hidden class=anchor aria-hidden=true href=#cleaning-up>#</a></h3><p>10 seconds after validating the daemonset was up the attacker begins to cleanup and harden the cluster from further attack. At <code>2022-10-23 12:39:40.748</code> a request was made to delete the clusterrolebinding for <code>cluster-system-anonymous</code>. This effectively prevents anyone else from connecting to the cluster without authentication.</p><p><img loading=lazy src=images/anondelete.png alt=anondelete.png title=anondelete></p><p>Using kubectl the command would look something similar to:</p><pre tabindex=0><code>kubectl delete clusterrolebinding cluster-system-anonymous
</code></pre><p>Next, two more commands came in a few seconds later. The first was to delete a daemonset <code>api-proxy</code> in the kube-system namespace and another to delete the clusterrolebinding <code>kube-controller-manager</code> created for this attack.</p><p><img loading=lazy src=images/kubecontrollerdelete.png alt=kubecontrollerdelete.png title=kubecontrollerdelete.png></p><p>The attacker issued a few more commands but they all fail because they have deleted the clusterrolebinding and have effectivly locked themselves out of the cluster as well. The only exception is the daemonset they created which could be a foothold into the cluster.</p><p>For a complete timeline of the attack check out the &lsquo;Complete Timeline of the Attack&rsquo; section at the bottom of the page.</p><hr><h3 id=process-analysis>Process Analysis<a hidden class=anchor aria-hidden=true href=#process-analysis>#</a></h3><p>To determine the process(s) associated with the malicious pods we first needed to determine a container id on the host. The kubectl command below revealed the pod name as well as the host where the container was running.</p><pre tabindex=0><code>kubectl get pods -n kube-system -o wide

NAME                     READY   STATUS       RESTARTS    AGE     IP              NODE
kube-controller-cq8f8    1/1     Running      0           4d5h    100.96.2.4      ip-172-20-45-237.ec2.internal
kube-controller-m2gjc    1/1     Running      0           6d20h   100.96.1.14     ip-172-20-49-244.ec2.internal
</code></pre><p>Pushing deeper we can query the details for one of the pods and determine a containerid associated with it:</p><pre tabindex=0><code>kubectl get pod kube-controller-cq8f8 -o yaml |grep -i containerid

Containerid: 643747d8420547509c2a80f791ef139647fbce9df53478530f9d1e217f1eb982
</code></pre><p>On the host itself running <code>pstree</code> and searching for the container id the results below were retirmed showing the process of the container was <code>6340</code>. The only process running in the container was pid <code>6554</code>, and everything under it was a thread of the process.</p><p><img loading=lazy src=images/pstree3.png alt=pstree3.png title=pstree3.png></p><p>Knowing this, the running <code>kube-controller</code> binary was copied out of the proc folder with <code>cp /proc/6554/exe /tmp/6554</code> and analysis of the binary began.</p><p>During initial analysis attempting to determine if the binary was packed (it&rsquo;s not) the binary showed signs of being an unpacked coin miner.</p><p><img loading=lazy src=images/upx.png alt=upx.png title=upx.png></p><p>To further confirm the binary was a coin miner (or at least some part of it was) strings was ran searching for <code>xmrig</code>.</p><p><img loading=lazy src=images/xmrigbinary.png alt=xmrigbinary.png title=xmrigbinary.png></p><p>The results output confirmed this was a coin miner. For further corroboration <a href=https://www.virustotal.com/gui/file/3928c5874249cc71b2d88e5c0c00989ac394238747bb7638897fc210531b4aab>VirusTotal</a> also returned results on this binary being a coin miner.</p><p>Network connections for the process were also inspected but did not point to anything interesting. Periodically the outbound established ip address would rotate. All observed outbound connections were made to addresses hosted in aws. The network traffic was all encrypted. At this point diving deeper into the network traffic did not seem necessary.</p><hr><h3 id=image-analysis>Image Analysis<a hidden class=anchor aria-hidden=true href=#image-analysis>#</a></h3><p>Carving out the image and viewing it layer by layer helped to confirm what was learned when conducting analysis of the process. There are three layers in this image. The first was the base image used by the attacker to add malicious components to and appears to be an alpine linux image.</p><p><img loading=lazy src=images/dive1.png alt=dive1.png title=dive1.png></p><p>The second layer was the result of the COPY command moving the <code>kube-controller</code> binary into the image.</p><p><img loading=lazy src=images/dive2.png alt=dive2.png title=dive2.png></p><p>The third image shows a file <code>.xmrig.json</code> being copied into the image in roots home folder.</p><p><img loading=lazy src=images/dive3.png alt=dive3.png title=dive3.png></p><p>Based on the layer information and the information observed in the daemonset definition file we can infer the Dockerfile for this image would look something similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>from</span><span class=s> alpine:3.13.1</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./kube-controller /kube-controller<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./xmrig.json /root/.xmrig.json<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> chmod <span class=m>755</span> /kube-controller<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;/kube-controller&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>After extracting the layers, we can access the json config file for xmrig and get the wallet id as well as other information.</p><p><img loading=lazy src=images/xmriguser.png alt=xmriguser.png title=xmriguser.png></p><p>On docker hub this image had been pulled over 10,000 times.</p><p><img loading=lazy src=images/dockerhub.png alt=dockerhub.png title=dockerhub.png></p><p>The image no longer exists on dockerhub and the entire <code>kubrnetesio</code> account has been removed.</p><hr><h3 id=prevention>Prevention<a hidden class=anchor aria-hidden=true href=#prevention>#</a></h3><p>To prevent this there are a few different things that can be done:</p><ul><li>Don&rsquo;t allow anonymous access</li><li>Don&rsquo;t expose the api server to the entire Internet</li><li>Only allow signed trusted images to run on the cluster</li><li>Build alerts for successful anonymous access. These can be written in a SIEM or via a runtime agent running in the cluster such as Falco.</li><li>Build alerts for cluster-admin binds. Just like the previous entry the SIEM or something such as Falco or osquery can be utilized here.</li><li>Make sure your cluster is up to date. Initially I ran this honeypot on the current release of Kubernetes, but the attacks would stop after creating the clusterrolebinding and attempting to query for the service account token. As of Kubernetes 1.24 service account tokens are no longer automatically generated, and they must be manually generated. This group of malicious actors have yet to take this into consideration so their attacks fail despite the anonymous user having full admin permissions on the cluster.</li></ul><hr><h3 id=complete-timeline-of-the-attack>Complete Timeline of the Attack<a hidden class=anchor aria-hidden=true href=#complete-timeline-of-the-attack>#</a></h3><table><thead><tr><th>Event Time</th><th>username</th><th>userAgent</th><th>verb</th><th>requestURI</th><th>Response Code</th></tr></thead><tbody><tr><td>2022-10-23 12:30:24.602</td><td>system:anonymous</td><td>python-requests/2.27.1</td><td>list</td><td>/api/v1/secrets/</td><td>200</td></tr><tr><td>2022-10-23 12:37:31.733</td><td>system:anonymous</td><td>curl/7.64.0</td><td>create</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings</td><td>201</td></tr><tr><td>2022-10-23 12:37:41.482</td><td>system:anonymous</td><td>curl/7.64.0</td><td>list</td><td>/api/v1/namespaces/kube-system/secrets</td><td>200</td></tr><tr><td>2022-10-23 12:37:48.033</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/api?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:49.447</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.119</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/autoscaling/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/events.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/authentication.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apiregistration.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apps/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/storage.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/certificates.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.281</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/flowcontrol.apiserver.k8s.io/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.848</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/api/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.859</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/events.k8s.io/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/autoscaling/v2?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/batch/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/policy/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/node.k8s.io/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/authorization.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/storage.k8s.io/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apiextensions.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/rbac.authorization.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/node.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/networking.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/policy/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/discovery.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:51.969</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/autoscaling/v2beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.062</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/admissionregistration.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.062</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/scheduling.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.062</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/autoscaling/v2beta2?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.154</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/discovery.k8s.io/v1beta1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.155</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/flowcontrol.apiserver.k8s.io/v1beta2?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.155</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/batch/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:52.155</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/coordination.k8s.io/v1?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:37:53.339</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/apps/v1/namespaces/default/deployments/worker-deployment</td><td>404</td></tr><tr><td>2022-10-23 12:37:57.898</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/apps/v1/namespaces/kube-system/deployments/api-proxy</td><td>404</td></tr><tr><td>2022-10-23 12:38:01.766</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/api/v1/namespaces/default/pods/kube-secure-fhgxtsjh</td><td>404</td></tr><tr><td>2022-10-23 12:38:06.067</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/api/v1/namespaces/default/pods/kube-secure-fhgxt</td><td>404</td></tr><tr><td>2022-10-23 12:38:10.451</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller</td><td>404</td></tr><tr><td>2022-10-23 12:38:12.762</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/api/v1/namespaces/kube-system</td><td>200</td></tr><tr><td>2022-10-23 12:38:16.765</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/openapi/v2?timeout=32s</td><td>200</td></tr><tr><td>2022-10-23 12:38:19.830</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller</td><td>404</td></tr><tr><td>2022-10-23 12:38:20.495</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/api/v1/namespaces/kube-system</td><td>200</td></tr><tr><td>2022-10-23 12:38:21.132</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>create</td><td>/apis/apps/v1/namespaces/kube-system/daemonsets?fieldManager=kubectl-client-side-apply&fieldValidation=Strict</td><td>201</td></tr><tr><td>2022-10-23 12:38:30.085</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>get</td><td>/apis/apps/v1/namespaces/kube-system/daemonsets/kube-controller</td><td>200</td></tr><tr><td>2022-10-23 12:39:15.761</td><td>system:anonymous</td><td>curl/7.64.0</td><td>list</td><td>/api/v1/namespaces/kube-system/secrets</td><td>200</td></tr><tr><td>2022-10-23 12:39:40.748</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings/cluster-system-anonymous?timeout=10s</td><td>200</td></tr><tr><td>2022-10-23 12:39:42.343</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/apps/v1/namespaces/kube-sytem/daemonsets/api-proxy?timeout=10s</td><td>404</td></tr><tr><td>2022-10-23 12:39:46.760</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings/kube-controller-manager?timeout=10s</td><td>200</td></tr><tr><td>2022-10-23 12:39:49.713</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings?fieldSelector=metadata.name%3Dkube-controller-manager&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:01.102</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/api/v1/namespaces/default/pods/kube-secure-fhgxtsjh?timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:08.544</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/api/v1/namespaces/default/pods/kube-secure-fhgxt?timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:12.611</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>delete</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings/eks-admin?timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:18.294</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/secrets?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:24.705</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/pods?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:33.352</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/configmaps?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:42.762</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/networking.k8s.io/v1/ingresses?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:51.379</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/rbac.authorization.k8s.io/v1/clusterroles?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:40:55.609</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/rbac.authorization.k8s.io/v1/clusterrolebindings?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:41:03.747</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/rbac.authorization.k8s.io/v1/roles?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:41:07.045</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/apis/rbac.authorization.k8s.io/v1/rolebindings?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:41:11.267</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/services?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:41:15.285</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/serviceaccounts?limit=500&timeout=10s</td><td>403</td></tr><tr><td>2022-10-23 12:41:19.253</td><td>system:serviceaccount:kube-system:default</td><td>kubectl/v1.24.4 (linux/amd64) kubernetes/95ee5ab</td><td>list</td><td>/api/v1/nodes?limit=500&timeout=10s</td><td>403</td></tr></tbody></table></div><footer class=post-footer><ul class=post-tags><li><a href=https://jellyparks.com/tags/containers/>containers</a></li><li><a href=https://jellyparks.com/tags/linux/>linux</a></li><li><a href=https://jellyparks.com/tags/dfir/>dfir</a></li><li><a href=https://jellyparks.com/tags/kubernetes/>kubernetes</a></li></ul><nav class=paginav><a class=next href=https://jellyparks.com/posts/k8s-api-logs-for-responders/><span class=title>Next Page »</span><br><span>kubernetes_logs_for_responders</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on twitter" href="https://twitter.com/intent/tweet/?text=kubernetes_honeypot_adventures&url=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f&hashtags=containers%2clinux%2cdfir%2ckubernetes"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f&title=kubernetes_honeypot_adventures&summary=kubernetes_honeypot_adventures&source=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f&title=kubernetes_honeypot_adventures"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on whatsapp" href="https://api.whatsapp.com/send?text=kubernetes_honeypot_adventures%20-%20https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share kubernetes_honeypot_adventures on telegram" href="https://telegram.me/share/url?text=kubernetes_honeypot_adventures&url=https%3a%2f%2fjellyparks.com%2fposts%2fk8s-honeypot%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jellyparks.com>JellyParks</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>